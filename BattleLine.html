<html>
<head>
<script type="text/javascript" src="js/BattleLineCore.js"></script>
<script type="text/javascript" src="js/BattleLineFactions.js"></script>
<script type="text/javascript" src="data/map1.json"></script>
<script type="text/javascript" src="data/map2.json"></script>
</head>
<body>
<canvas id="display" width="600" height="600" ></canvas>
<div id="teamList" style="position:absolute; top:0px; left:600px">

<div id="team1" style="position:absolute; top:0px; left:0px; width:200px">Team 1</div>
<div id="team2" style="position:absolute; top:0px; left:200px; width:200px">Team 2</div>
<div id="planets" style="position:absolute; top:0px; left:400px; width:200px">Planets</div>
</div>
<script>
    var canvas = document.getElementById( 'display' );
    var context = canvas.getContext( '2d' );
    
    BattleLine.initialize( map2 );
    BattleLine.Factions.initialize( 3 );
    console.log( BattleLine.Factions.team1 );
    console.log( BattleLine.Factions.team2 );
    
    BattleLine.drawMap( canvas, context );
    
    canvas.addEventListener( 'mousedown', function (event) {
        var xOffset = canvas.offsetLeft + (canvas.width - BattleLine.mapData.Dimensions.width) / 2;
        var yOffset = canvas.offsetTop + (canvas.height - BattleLine.mapData.Dimensions.height) / 2;
        
        var nearestPlanetID = BattleLine.util.getPlanetAtXY( event.pageX - xOffset, event.pageY - yOffset );
        
        if ( nearestPlanetID >= 0 ) {
            var nearestPlanet = BattleLine.mapData.Planets[nearestPlanetID];
            if ( event.button == 0 ) {
                nearestPlanet.priority[0] = Math.min(10, nearestPlanet.priority[0] + 1);
            }
            else if ( event.button == 2 ) {
                nearestPlanet.priority[0] = Math.max(1, nearestPlanet.priority[0] - 1);
            }
            BattleLine.Factions.updateDisplay();
            BattleLine.drawMap( canvas, context );
        }
    });
    canvas.addEventListener( 'contextmenu', function(event) {
        event.preventDefault();
    });
    document.addEventListener( 'keydown', function(event) {
        console.log(event.keyCode);
        if ( event.keyCode == 32 ) {
            console.log( BattleLine.Factions.generateBattleQueue() );
        }
    });
</script>
</body>